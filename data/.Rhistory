library(matrixStats)
InvertsVar<-colVars(InvertsMatrix)
InvertsMeans<-colMeans(InvertsMatrix)
plot(log10(InvertsVar)~log10(InvertsMeans))
abline(0,1)
mean(InvertsVar)/mean(InvertsMeans)
VarsMeans<-data.frame(InvertsVar, InvertsMeans)
VarsMeansMelt<-melt(VarsMeans)
ggplot(VarsMeansMelt, aes(x=log10(value)))+
geom_density(aes(color=variable, fill=variable), alpha=0.5)
install.packages("ggbiplot")
?colVars
install.packages("matrixStats")
install.packages("matrixStats")
library(matrixStats)
InvertsVar<-colVars(InvertsMatrix)
InvertsMeans<-colMeans(InvertsMatrix)
plot(log10(InvertsVar)~log10(InvertsMeans))
abline(0,1)
mean(InvertsVar)/mean(InvertsMeans)
VarsMeans<-data.frame(InvertsVar, InvertsMeans)
VarsMeansMelt<-melt(VarsMeans)
ggplot(VarsMeansMelt, aes(x=log10(value)))+
geom_density(aes(color=variable, fill=variable), alpha=0.5)
#load invert data table
Inverts<-read.csv("C:\\Users\\Thomas\\Desktop\\Yosemite Communities Analysis\\Data\\BenthicInvertebrate_AllGenera.csv", header=T)
Inverts$LakeID<-as.factor(Inverts$LakeID)
#combine taxa represented in two vectors
names(Inverts)
#Combine the taxa repeated in two vectors:
Inverts$LLEU<-Inverts$LLEU+Inverts$LLEU.1
Inverts$LLEU.1<-NULL
Inverts$HEST<-Inverts$HEST+Inverts$HEST.1
Inverts$HEST.1<-NULL
Inverts$PHAR<-Inverts$PHAR+Inverts$PHAR.1
Inverts$PHAR.1<-NULL
Inverts$PISI<-Inverts$PISI+Inverts$PISI.1
Inverts$PISI.1<-NULL
Inverts$CERA<-Inverts$CERA+Inverts$CERA.1
Inverts$CERA.1<-NULL
Inverts$DASY<-Inverts$DASY+Inverts$DASY.1
Inverts$DASY.1<-NULL
#create data frame of lake IDs to use for query:
InvertLakes<-data.frame(Inverts$LakeID)
names(InvertLakes)<-c("LakeID")
Inverts<-Inverts[,-1]
#run query to select lake characteristics for lakes in invert table:
library(sqldf)
LakeSQL<-sqldf("SELECT *
FROM Lakes
INNER JOIN InvertLakes
ON InvertLakes.LakeID=Lakes.LakeID;")
LakeSQL$LakeID<-as.factor(LakeSQL$LakeID)
LakeSQL[,28]<-NULL
#remove terrestrial substrates:
LakeSQL<-subset(LakeSQL, select=-c(23:27))
#express substrates as proportions
names(LakeSQL)
LakSQLSubstrateTotals<-rowSums(LakeSQL[,c(15:22)], na.rm=T)
LakeSQL[,c(15:22)]/LakSQLSubstrateTotals
LakeSQL<-data.frame(subset(LakeSQL, select=-c(15:22)), LakeSQL[,c(15:22)]/LakSQLSubstrateTotals)
#code lake types
LakeSQL$LakeType[LakeSQL$lake_type_code==1]<-"Perennial"
LakeSQL$LakeType[LakeSQL$lake_type_code==3]<-"Unmapped"
LakeSQL$LakeType[LakeSQL$lake_type_code==4]<-"StreamWidening"
LakeSQL$LakeType[LakeSQL$lake_type_code==5]<-"Marsh"
LakeSQL$LakeType[LakeSQL$lake_type_code==10]<-"UnmappedMarsh"
LakeSQL$LakeType[LakeSQL$lake_type_code==11]<-"Ephemeral"
LakeSQL$LakeType[LakeSQL$lake_type_code==12]<-"Meadow"
LakeSQL$LakeType<-as.factor(LakeSQL$LakeType)
#lump some basins/drainages:
levels(LakeSQL$lake_drainage_name)[98:184]
table(LakeSQL$lake_drainage_name)
#select fishless lakes from both dataframes:
NoFish<-which(LakeSQL$actual_fish_presence=="No")
InvertsNoFish<-Inverts[NoFish,]
LakeNoFish<-LakeSQL[NoFish,]
#remove lake 70451 from both dataframes
###What was wrong with lake 70451?
###70451 has zero individuals reported for it - which seems weird?
No70451<-which(LakeNoFish$LakeID!="70451")
InvertsNoFishno70451<-InvertsNoFish[No70451,]
rowSums(InvertsNoFishno70451)
LakeNoFishno70451<-LakeNoFish[No70451,]
library(vegan)
LakeCCA<-subset(LakeNoFishno70451, select=c(lake_max_depth, lake_area_nbr, lake_perimeter_nbr, lake_elevation_nbr, lake_east_utm, lake_north_utm, Bedrock, Silt))
LakeCCA<-na.replace(LakeCCA,0)
print(CCAresult<-cca(InvertsNoFishno70451, LakeCCA))
CCA1<-plot(CCAresult, scaling=1)
points(CCA1,what='sites',InvertsNoFishno70451$CALB>0,col="black", pch=21, bg="dark green", cex=2)
points(CCA1,what='sites',InvertsNoFishno70451$CAEN>0,col="black", pch=21, bg="red", cex=2)
points(CCA1,what='sites',InvertsNoFishno70451$AMEL>0,col="black", pch=21, bg="blue", cex=2)
CCA2<-plot(CCAresult, scaling=2)
summary(CCAresult)
#Invert matrix dissimilarities
InvertDist<-vegdist(as.matrix(InvertsNoFishno70451),method="bray")
#set seed for random number generation and reproducibility.  42 is a perfectly normal number.
set.seed=42 #
nmds1<-nmds(InvertDist, k=1)
nmds2<-nmds(InvertDist, k=2)
nmds3<-nmds(InvertDist, k=3)
nmds4<-nmds(InvertDist, k=4)
nmds5<-nmds(InvertDist, k=5)
stresses<-data.frame(c(1,2,3,4,5),c(nmds1$stress,nmds2$stress,nmds3$stress,nmds4$stress,nmds5$stress))
names(stresses)<-c("axes","stress")
ggplot(data=stresses, aes(x=axes,y=stress))+
geom_line()
plot(nmds3)
print(nmdsFIT<-envfit(nmds3~lake_max_depth+lake_area_nbr+lake_perimeter_nbr+lake_elevation_nbr+lake_east_utm+lake_north_utm+Bedrock+Silt, data=LakeCCA))
plot(nmdsFIT)
ordisurf(nmds3, LakeCCA$lake_elevation_nbr, add=F)
ordisurf(nmds3, LakeCCA$lake_max_depth, add=F)
ordisurf(nmds3, LakeCCA$lake_area_nbr, add=F)
ordisurf(nmds3, LakeCCA$lake_perimeter_nbr, add=F)
ordisurf(nmds3, LakeCCA$lake_east_utm, add=F)
ordisurf(nmds3, LakeCCA$lake_north_utm, add=F)
ordisurf(nmds3, LakeCCA$Silt, add=F)
ordisurf(nmds3, LakeCCA$Bedrock, add=F)
CCA0<-cca(InvertsNoFishno70451~1, data=LakeCCA) #this is basically a correspondence analysis
CCA1<-cca(InvertsNoFishno70451~LakeCCA$lake_elevation_nbr, data=LakeCCA)
CCA2<-cca(InvertsNoFishno70451~LakeCCA$lake_elevation_nbr+LakeCCA$Silt, data=LakeCCA)
CCA3<-cca(InvertsNoFishno70451~LakeCCA$lake_elevation_nbr+LakeCCA$Silt+LakeCCA$lake_max_depth, data=LakeCCA)
CCAall<-cca(InvertsNoFishno70451~., LakeCCA)
anova(CCA0)
anova(CCA1)
anova(CCA2)
anova(CCA3)
anova(CCAall)
CCAstep<-step(CCA0, scope = formula(CCAall), test = "perm")
pred<-calibrate(CCAgooder)
plot(CCAgooder, display = c("bp", "wa", "lc"))
ef <- with(LakeCCA, ordisurf(CCAgooder, lake_elevation_nbr, display = "lc", add = TRUE))
CCA0<-cca(InvertsNoFishno70451~1, data=LakeCCA) #this is basically a correspondence analysis
CCA1<-cca(InvertsNoFishno70451~LakeCCA$lake_elevation_nbr, data=LakeCCA)
CCA2<-cca(InvertsNoFishno70451~LakeCCA$lake_elevation_nbr+LakeCCA$Silt, data=LakeCCA)
CCA3<-cca(InvertsNoFishno70451~LakeCCA$lake_elevation_nbr+LakeCCA$Silt+LakeCCA$lake_max_depth, data=LakeCCA)
CCAall<-cca(InvertsNoFishno70451~., LakeCCA)
anova(CCA0)
anova(CCA1)
anova(CCA2)
anova(CCA3)
anova(CCAall)
CCAstep<-step(CCA0, scope = formula(CCAall), test = "perm")
CCAgooder<-cca(InvertsNoFishno70451 ~ lake_elevation_nbr + Silt + lake_east_utm +
lake_max_depth + lake_north_utm, data=LakeCCA)
CCAstep<-step(CCA0, scope = formula(InvertsNoFishno70451 ~ lake_elevation_nbr + Silt + lake_east_utm + lake_max_depth + lake_north_utm), test = "perm")
vif.cca(CCAall)
vif.cca(CCA3)
vif.cca(CCAgooder)
pred<-calibrate(CCAgooder)
plot(CCAgooder, display = c("bp", "wa", "lc"))
ef <- with(LakeCCA, ordisurf(CCAgooder, lake_elevation_nbr, display = "lc", add = TRUE))
CCA2<-plot(CCAresult, scaling=1)
points(CCA2,what='sites',InvertsNoFishno70451$AMEL>0,col="black", pch=21, bg="blue", cex=2)
#identify(CCA2, "sites")
#identify(CCA2, "spec")
g<-levels(LakeNoFishno70451$LakeID)[20]#
subset(LakeNoFishno70451, LakeNoFishno70451$LakeID==g)
Inverts70167<-subset(InvertsNoFishno70451, LakeNoFishno70451$LakeID==g)
relAbund70167<-data.frame(t(Inverts70167/rowSums(Inverts70167))[which(t(Inverts70167)>0)],dimnames(Inverts70167[which(t(Inverts70167)>0)])[[2]])
names(relAbund70167)<-c("RelAbund","Taxa")
which(names(Inverts)=="ACAR")
LumpedHawkinsInverts<-data.frame(subset(Inverts, select=-c(101:170)), rowSums(Inverts[,101:170]))
LumpedHawkinsInverts<-rename(LumpedHawkinsInverts, c(rowSums.Inverts...101.170..="CHIR"))
Ladau<-read.csv("C:\\Users\\Thomas\\Desktop\\Yosemite Communities Analysis\\Data\\BenthicInvertebrate_ChironomidsAtFamilyOnly.csv", header=T)
LadauInverts<-subset(Ladau, LakeID!="70451")
#LadauInverts<-as.matrix(Ladau[,-1])
#LumpedHawkins:
#select fishless lakes from both dataframes:
LumpedNoFish<-which(LakeSQL$actual_fish_presence=="No")
LumpedInvertsNoFish<-LumpedHawkinsInverts[NoFish,]
LumpedLakeNoFish<-LakeSQL[NoFish,]
#remove lake 70451 from both dataframes
###What was wrong with lake 70451?
###70451 has zero individuals reported for it - which seems weird?
LumpedNo70451<-which(LumpedLakeNoFish$LakeID!="70451")
LumpedInvertsNoFishno70451<-LumpedInvertsNoFish[No70451,]
#rowSums(LumpedInvertsNoFishno70451)
LumpedLakeNoFishno70451<-LumpedLakeNoFish[No70451,]
LumpedLakeCCA<-subset(LumpedLakeNoFishno70451, select=c(lake_max_depth, lake_area_nbr, lake_perimeter_nbr, lake_elevation_nbr, lake_east_utm, lake_north_utm, Bedrock, Silt))
LumpedLakeCCA<-na.replace(LumpedLakeCCA,0)
#Ladau Inverts:
#select fishless lakes from both dataframes:
NoFish<-which(LakeSQL$actual_fish_presence=="No")
LadauInvertsNoFish<-LadauInverts[NoFish,]
LadauLakeNoFish<-LakeSQL[NoFish,]
#remove lake 70451 from both dataframes
###What was wrong with lake 70451?
###70451 has zero individuals reported for it - which seems weird?
No70451<-which(LakeNoFish$LakeID!="70451")
LadauInvertsNoFishno70451<-LadauInvertsNoFish[No70451,]
#rowSums(LadauInvertsNoFishno70451)
LadauLakeNoFishno70451<-LadauLakeNoFish[No70451,]
which(rowSums(LadauInvertsNoFishno70451)==0)#33
#remove row 33 from both Lakes and Inverts.
#What is row 33?
LadauLakeNoFishno70451[33,]
#LadauInvertsNoFishno70451[33,]
#It is lake 70343.
No70343<-which(LadauLakeNoFishno70451$LakeID!=70343)
LadauLakeNoFishno70451no70343<-LadauLakeNoFishno70451[No70343,]
LadauInvertsNoFishno70451no70343<-LadauInvertsNoFishno70451[No70343,]
LadauLakeCCA<-subset(LadauLakeNoFishno70451no70343, select=c(lake_max_depth, lake_area_nbr, lake_perimeter_nbr, lake_elevation_nbr, lake_east_utm, lake_north_utm, Bedrock, Silt))
LadauLakeCCA<-na.replace(LadauLakeCCA,0)
print(LumpedCCAresult<-cca(LumpedInvertsNoFishno70451, LumpedLakeCCA))
print(LadauCCAresult<-cca(LadauInvertsNoFishno70451no70343, LadauLakeCCA))
par(mfrow=c(1,2))
plot(LumpedCCAresult, scaling=1)
plot(LadauCCAresult, scaling=1)
par(mfrow=c(1,1))
plot(LumpedHawkinsInverts$CHIR~LadauInverts$CHIR)
abline(0,1)
#NMDS on Lumped data:
library(vegan)
LumpedInvertDist<-vegdist(LumpedInvertsNoFishno70451, method="bray")
set.seed=42 #
Lumpednmds1<-nmds(LumpedInvertDist, k=1)
Lumpednmds2<-nmds(LumpedInvertDist, k=2)
Lumpednmds3<-nmds(LumpedInvertDist, k=3)
Lumpednmds4<-nmds(LumpedInvertDist, k=4)
Lumpednmds5<-nmds(LumpedInvertDist, k=5)
Lumpedstresses<-data.frame(c(1,2,3,4,5),c(Lumpednmds1$stress,Lumpednmds2$stress,Lumpednmds3$stress,Lumpednmds4$stress,Lumpednmds5$stress))
names(Lumpedstresses)<-c("axes","stress")
ggplot(data=Lumpedstresses, aes(x=axes,y=stress))+
geom_line()
#NMDS on Lumped data:
LadauInvertDist<-vegdist(LadauInvertsNoFishno70451no70343, method="bray")
set.seed=42 #
Ladaunmds1<-nmds(LadauInvertDist, k=1)
Ladaunmds2<-nmds(LadauInvertDist, k=2)
Ladaunmds3<-nmds(LadauInvertDist, k=3)
Ladaunmds4<-nmds(LadauInvertDist, k=4)
Ladaunmds5<-nmds(LadauInvertDist, k=5)
Ladaustresses<-data.frame(c(1,2,3,4,5),c(Ladaunmds1$stress,Ladaunmds2$stress,Ladaunmds3$stress,Ladaunmds4$stress,Ladaunmds5$stress))
names(Ladaustresses)<-c("axes","stress")
ggplot(data=Ladaustresses, aes(x=axes,y=stress))+
geom_line()
par(mfrow=c(1,2))
plot(Lumpednmds3)
LumpednmdsFIT<-envfit(Lumpednmds3~lake_max_depth+lake_area_nbr+lake_perimeter_nbr+lake_elevation_nbr+lake_east_utm+lake_north_utm+Bedrock+Silt, data=LumpedLakeCCA)
plot(LumpednmdsFIT)
points(Lumpednmds3,LumpedInvertsNoFishno70451$CALB>0,col="black", pch=21, bg="grey", cex=1)
points(Lumpednmds3,LumpedInvertsNoFishno70451$AMEL>0,col="black", pch=21, bg="blue", cex=1)
plot(Ladaunmds3)
LadaunmdsFIT<-envfit(Ladaunmds3~lake_max_depth+lake_area_nbr+lake_perimeter_nbr+lake_elevation_nbr+lake_east_utm+lake_north_utm+Bedrock+Silt, data=LadauLakeCCA)
plot(LadaunmdsFIT)
points(Ladaunmds3,LadauInvertsNoFishno70451no70343$CALB>0,col="black", pch=21, bg="grey", cex=1)
points(Ladaunmds3,LadauInvertsNoFishno70451no70343$AMEL>0,col="black", pch=21, bg="blue", cex=1)
par(mfrow=c(1,1))
par(mfrow=c(1,2))
plot(Lumpednmds3)
LumpednmdsFIT<-envfit(Lumpednmds3~lake_max_depth+lake_area_nbr+lake_perimeter_nbr+lake_elevation_nbr+lake_east_utm+lake_north_utm+Bedrock+Silt, data=LumpedLakeCCA)
plot(LumpednmdsFIT)
points(Lumpednmds3,LumpedInvertsNoFishno70451$CHIR>0,col="black", pch=21, bg="dark green", cex=1)
plot(Ladaunmds3)
LadaunmdsFIT<-envfit(Ladaunmds3~lake_max_depth+lake_area_nbr+lake_perimeter_nbr+lake_elevation_nbr+lake_east_utm+lake_north_utm+Bedrock+Silt, data=LadauLakeCCA)
plot(LadaunmdsFIT)
points(Ladaunmds3,LadauInvertsNoFishno70451no70343$CHIR>0,col="black", pch=21, bg="dark green", cex=1)
par(mfrow=c(1,1))
lowlakes<-subset(LadauLakeNoFishno70451no70343,  lake_elevation_nbr<2000, select=c(LakeID))
highlakes<-subset(LadauLakeNoFishno70451no70343,  lake_elevation_nbr>3000, select=c(LakeID))
siltylakes<-subset(LadauLakeNoFishno70451no70343,  lake_elevation_nbr>3000, select=c(LakeID))
rockylakes<-subset(LadauLakeNoFishno70451no70343,  Silt<.05, select=c(LakeID))
highsiltylakes<-subset(LadauLakeNoFishno70451no70343,  lake_elevation_nbr>3000 & Silt>.30, select=c(LakeID))
lownotsiltylakes<-subset(LadauLakeNoFishno70451no70343,  lake_elevation_nbr<2200 & Silt<.05, select=c(LakeID))
par(mfrow=c(1,2))
plot(Lumpednmds3)
LumpednmdsFIT<-envfit(Lumpednmds3~lake_max_depth+lake_area_nbr+lake_perimeter_nbr+lake_elevation_nbr+lake_east_utm+lake_north_utm+Bedrock+Silt, data=LumpedLakeCCA)
plot(LumpednmdsFIT)
points(Lumpednmds3,LumpedLakeNoFishno70451$LakeID==70021, pch=21, col="black", bg="green", cex=2)
points(Lumpednmds3,LumpedLakeNoFishno70451$LakeID==70550, pch=21, col="black", bg="red", cex=2)
points(Lumpednmds3,LumpedLakeNoFishno70451$LakeID==70505, pch=21, col="black", bg="blue", cex=2)
points(Lumpednmds3,LumpedLakeNoFishno70451$LakeID==70134, pch=21, col="black", bg="black", cex=2)
points(Lumpednmds3,LumpedLakeNoFishno70451$LakeID==72553, pch=21, col="black", bg="gray", cex=2)
plot(Ladaunmds3)
LadaunmdsFIT<-envfit(Ladaunmds3~lake_max_depth+lake_area_nbr+lake_perimeter_nbr+lake_elevation_nbr+lake_east_utm+lake_north_utm+Bedrock+Silt, data=LadauLakeCCA)
plot(LadaunmdsFIT)
points(Ladaunmds3,LadauLakeNoFishno70451$LakeID==70021, pch=21, col="black", bg="green", cex=2)
points(Ladaunmds3,LadauLakeNoFishno70451$LakeID==70550, pch=21, col="black", bg="red", cex=2)
points(Ladaunmds3,LadauLakeNoFishno70451$LakeID==70505, pch=21, col="black", bg="blue", cex=2)
points(Ladaunmds3,LadauLakeNoFishno70451$LakeID==70134, pch=21, col="black", bg="black", cex=2)
points(Ladaunmds3,LadauLakeNoFishno70451$LakeID==72553, pch=21, col="black", bg="gray", cex=2)
par(mfrow=c(1,1))
par(mfrow=c(2,1))
ordiplot(Lumpednmds3, choices = c(1, 2), type="text")
ordiplot(Ladaunmds3, choices = c(1, 2), type="text")
par(mfrow=c(1,1))
Inverts<-read.csv("C:\\Users\\Thomas\\Desktop\\Yosemite Communities Analysis\\Data\\BenthicInvertebrate_AllGenera.csv", header=T)
str(Inverts)
names(Inverts)
Ladau<-read.csv("C:\\Users\\Thomas\\Desktop\\Yosemite Communities Analysis\\Data\\BenthicInvertebrate_ChironomidsAtFamilyOnly.csv", header=T)
names(Ladau)
which(names(Ladau)=="CHIR")
data.frame(names(Inverts[1:105]),names(Ladau[-82]))
#OK, both contain the same taxa apart from CHIR
data.frame(Inverts$LakeID,Ladau$LakeID)
#but they do not contain the same lakes
#revisit the lakes that were not included in BOTH datasets:
#70027, 70451, 71224, 70473, 70434, 70343
which(Inverts$LakeID==70027)#3
which(Inverts$LakeID==70451)#69
which(Inverts$LakeID==71224)#200
which(Inverts$LakeID==70473)#77
which(Inverts$LakeID==70434)#33
which(Inverts$LakeID==70343)#38
which(Ladau$LakeID==70027)#3
which(Ladau$LakeID==70451)#69
which(Ladau$LakeID==71224)#201
which(Ladau$LakeID==70473)#77
which(Ladau$LakeID==70434)#63
which(Ladau$LakeID==70343)#38
LumpedHawkinsInverts<-data.frame(subset(Inverts, select=-c(101:170)), rowSums(Inverts[,101:170]))
LumpedHawkinsInverts<-rename(LumpedHawkinsInverts, c(rowSums.Inverts...101.170..="CHIR"))
Inverts$LakeID[-c(3,69,200,77,33,38),]
Inverts$LakeID[-c(3,69,200,77,33,38)]
Inverts<-Inverts$LakeID[-c(3,69,200,77,33,38),]
Inverts<-Inverts[-c(3,69,200,77,33,38),]
which(Ladau$LakeID==70434)#63
which(Inverts$LakeID==70434)#33
Ladau<-Ladau[-c(3,69,201,77,63,38),]
data.frame(Ladau$LakeID)
Inverts<-read.csv("C:\\Users\\Thomas\\Desktop\\Yosemite Communities Analysis\\Data\\BenthicInvertebrate_AllGenera.csv", header=T)
str(Inverts)
names(Inverts)
Ladau<-read.csv("C:\\Users\\Thomas\\Desktop\\Yosemite Communities Analysis\\Data\\BenthicInvertebrate_ChironomidsAtFamilyOnly.csv", header=T)
names(Ladau)
Length(Ladau$LakeID)
length(Ladau$LakeID)
min(Ladau$LakeID)
length(Inverts$LakeID)
min(Inverts$LakeID)
which(Ladau$LakeID==0)#
View(Ladau)
rowSums(Ladau$LakeID[195])
rowSum(Ladau$LakeID[195,])
rowSums(Ladau$LakeID[195,])
rowSums(Ladau$LakeID[195])
rowSums(Ladau[195,])
View(Ladau)
Ladaurow95<-Ladau[195,]
Ladaurow95<-Ladau[195,]
Ladaurow95
Ladau[195,]
length(Ladau$LakeID)
Inverts<-read.csv("C:\\Users\\Thomas\\Desktop\\Yosemite Communities Analysis\\Data\\BenthicInvertebrate_AllGenera.csv", header=T)
str(Inverts)
names(Inverts)
Ladau<-read.csv("C:\\Users\\Thomas\\Desktop\\Yosemite Communities Analysis\\Data\\BenthicInvertebrate_ChironomidsAtFamilyOnly.csv", header=T)
names(Ladau)
data.frame(Inverts$LakeID,Ladau$LakeID)
which(Inverts$LakeID==70027)#3
which(Inverts$LakeID==70451)#69
which(Inverts$LakeID==71224)#200
which(Inverts$LakeID==70473)#77
which(Inverts$LakeID==70434)#33
which(Inverts$LakeID==70343)#38
which(rowSums(Ladau[195,])=12)
rowSums(Ladau[195,])#12
which(rowSums(Ladau)==12)
Ladau[195,]
rowSums(Ladau[,104:106])
which(rowSums(Ladau[,104:106])==12)
Ladau[whichrowsumsare12,]
whichrowsumsare12<-which(rowSums(Ladau[,104:106])==12)
Ladau[whichrowsumsare12,]
whichrowsumsare12<-which(rowSums(Ladau[,104:106])==13)
Ladau[whichrowsumsare12,]
whichrowsumsare12<-which(rowSums(Ladau[,104:106])==11)
Ladau[whichrowsumsare12,]
Ladau[whichrowsumsare12,]
whichrowsumsare12<-which(rowSums(Ladau[,104:106])==12)
Ladau[whichrowsumsare12,]
which(Ladau$LakeID==70470)
Ladau[75,]
Ladau[74,]
Ladau[which(Ladau$LakeID==70704),]
Ladau[which(Ladau$LakeID==71092),]
Ladau[which(Ladau$LakeID==71224),]
Ladau[which(Ladau$LakeID==70704),]
Ladau[which(Ladau$LakeID==71092),]
Ladau[which(Ladau$LakeID==70704),]
Ladau[which(Ladau$LakeID==71092),]
Ladau[which(Ladau$LakeID==70704),]
Ladau[which(Ladau$LakeID==70470),]
Ladau[which(Ladau$LakeID==71092),]
Ladau[which(Ladau$LakeID==71224),]
library(dplyr)
library(ggplot2)
setwd("C:/Users/Thomas/Documents/2016-04-14-ucsb/data/")
mammals <- read.csv("mammal_stats.csv")
TailsnWhales<-filter(mammals, order == "Rodentia" | order == "Cetacea") #Any rodent or cetacean
View(TailsnWhales)
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales, main="Rodents and Cetaceans: Range v. Body Size", )
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Rodentia"),], pch=21, col="black", bg="light blue", cex=1.5)
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Cetacea"),], pch=21, col="black", bg="light green", cex=1.5)
TailsnWhales<-filter(mammals, order == "Rodentia" | order == "Cetacea") #Any rodent or cetacean
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales, main="Rodents and Cetaceans: Range v. Body Size", )
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales, main="Rodents and Cetaceans: Range v. Body Size")
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Rodentia"),], pch=21, col="black", bg="light blue", cex=1.5)
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Cetacea"),], pch=21, col="black", bg="light green", cex=1.5)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size)))+
geom_point(aes(color=order), size=2)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(color=order), size=2)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(color=order), size=3)+
scale_color_manual(c("light blue","light green"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(color=order), size=3)+
scale_color_manual(values=c("light blue","light green"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(color=order), size=3)+
scale_fill_manual(values=c("light blue","light green"))
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales, main="Rodents and Cetaceans: Range v. Body Size")
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Rodentia"),], pch=21, col="black", bg="light blue", cex=1.5)
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Cetacea"),], pch=21, col="black", bg="light green", cex=1.5)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(color=order), size=3, shape=21)+
scale_fill_manual(values=c("light blue","light green"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size), groups=order)+
geom_point(color="black", size=3)+
scale_shape_manual(values=c(21, 23))+
scale_fill_manual(values=c("light blue","light green"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size), groups=order)+
geom_point(color="black", size=3)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size), groups=order)+
geom_point(color="black", size=3)+
scale_shape_manual(values=c(21, 23))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size), groups=order)+
geom_point(color="black", size=3)+
scale_shape_manual(values=c(1, 2))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size, groups=order))+
geom_point(color="black", size=3)+
scale_shape_manual(values=c(1, 2))+
scale_fill_manual(values=c("light blue","light green"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size, groups=order))+
geom_point(color="black", size=3)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=3)+
scale_shape_manual(values=c(1, 2))+
scale_fill_manual(values=c("light blue","light green"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=3)+
scale_shape_manual(values=c(21, 23))+
scale_fill_manual(values=c("light blue","light green"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=3)+
scale_shape_manual(values=c(21, 24))+
scale_fill_manual(values=c("light blue","light green"))
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales, main="Rodents and Cetaceans: Range v. Body Size")
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Rodentia"),], pch=21, col="black", bg="light blue", cex=1.5)
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Cetacea"),], pch=24, col="black", bg="light green", cex=1.5)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=3)+
scale_shape_manual(values=c(24, 21))+
scale_fill_manual(values=c("light green", "light blue"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=5)+
scale_shape_manual(values=c(24, 21))+
scale_fill_manual(values=c("light green", "light blue"))
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=5)+
scale_shape_manual(values=c(24, 21))+
scale_fill_manual(values=c("light green", "light blue"))+
theme_bw()
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales,
main="Rodents and Cetaceans: Range v. Body Size",
xlab="Body Mass (kg)",
ylab="Litter Size",
bg="light grey")
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Rodentia"),], pch=21, col="black", bg="light blue", cex=1.5)
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Cetacea"),], pch=24, col="black", bg="light green", cex=1.5)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=5)+
scale_shape_manual(values=c(24, 21))+
scale_fill_manual(values=c("light green", "light blue"))+
ggtitle("Rodents and Cetaceans:\nLitter Size v. Body Size")+
xlab("Body Mass (g)")+
ylab("Litter Size")+
theme_classic()
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=5)+
scale_shape_manual(values=c(24, 21))+
scale_fill_manual(values=c("light green", "light blue"))+
ggtitle("Rodents and Cetaceans:\nLitter Size v. Body Size")+
xlab("Body Mass (g)")+
ylab("Litter Size")+
theme_bw()
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales,
main="Rodents and Cetaceans: Litter Size v. Body Size",
xlab="Body Mass (g)",
ylab="Litter Size")
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Rodentia"),], pch=21, col="black", bg="light blue", cex=1.5)
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Cetacea"),], pch=24, col="black", bg="light green", cex=1.5)
ggplot(data=TailsnWhales, aes(x=log10(adult_body_mass_g), y=litter_size))+
geom_point(aes(fill=order, shape=order),color="black", size=5)+
scale_shape_manual(values=c(24, 21))+
scale_fill_manual(values=c("light green", "light blue"))+
ggtitle("Rodents and Cetaceans:\nLitter Size v. Body Size")+
xlab("Body Mass (g)")+
ylab("Litter Size")+
theme_bw()
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales,
main="Rodents and Cetaceans:\nLitter Size v. Body Size",
xlab="Body Mass (g)",
ylab="Litter Size")
plot(litter_size~log10(adult_body_mass_g), data=TailsnWhales,
main="Rodents and Cetaceans:\nLitter Size v. Body Size",
xlab="Body Mass (g)",
ylab="Litter Size")
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Rodentia"),], pch=21, col="black", bg="light blue", cex=1.5)
points(litter_size~log10(adult_body_mass_g), data=TailsnWhales[which(TailsnWhales$order=="Cetacea"),], pch=24, col="black", bg="light green", cex=1.5)
